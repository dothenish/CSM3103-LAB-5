<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Display JSON Data</title>
    <style>
      div {
        margin: 20px;
      }
      table {
        border-collapse: collapse;
      }

      th,
      td {
        border: 1px solid black;
        padding: 8px;
      }
    </style>
  </head>

  <body>
    <h3>Choose Item</h3>
    <p id="demo2"></p>

    <script>
      function getProductLine() {
        var xhttp;
        xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("demo2").innerHTML = this.responseText;
          }
        };
        xhttp.open("GET", "https://skimtech.my/readproductline.php", true);
        xhttp.send();
      }
      getProductLine();

      // Function to show customer information based on the selected item
      function showCustomer(str) {
        var xhttp;
        if (str == "") {
          document.getElementById("txtHint").innerHTML = "";
          return;
        }
        xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            var jsonString = this.responseText;
            var jsonArray = JSON.parse(jsonString);

            // Display the number of objects and their attributes
            document.getElementById("numberOfObject").innerHTML =
              "Number of " + str + " Objects: " + jsonArray.length;
            document.getElementById("attributes").innerHTML =
              "Attributes: <b>" + (Object.keys(jsonArray[0]) + "</b>");

            // Create and populate the table with the JSON data
            displayTable.innerHTML = "";
            displayTable = document.getElementById("displayTable");
            const table = document.createElement("table");
            const thead = document.createElement("thead");
            const tbody = document.createElement("tbody");

            Object.keys(jsonArray[0]).forEach((key) => {
              const th = document.createElement("th");
              console.log(key);
              th.textContent = key;
              thead.appendChild(th);
            });
            table.appendChild(thead);

            jsonArray.forEach(function (record) {
              var row = document.createElement("tr");
              Object.keys(record).forEach(function (key) {
                var cell = document.createElement("td");
                cell.textContent = record[key];
                row.appendChild(cell);
              });
              tbody.appendChild(row);
            });

            table.appendChild(tbody);
            displayTable.appendChild(table);
          }
        };
        xhttp.open(
          "GET",
          "https://skimtech.my/getProductByChoice.php?q=" + str,
          true
        );
        xhttp.send();
      }
    </script>

    <!-- Div element to display the number of objects -->
    <div id="numberOfObject">Customer's information will be shown here</div>
    
    <!-- Div element to display the attributes -->
    <div id="attributes"></div>
    
    <!-- Div element to display the table -->
    <div id="displayTable"></div>
 
  </body>
</html>
